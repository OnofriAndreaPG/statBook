{
    "collab_server" : "",
    "contents" : "# Introduzione\n\nDifficilmente i fenomeni biologici possono essere descritti da funzioni lineari, salvo il caso in cui si consideri un intervallo di variazione della variabile indipendente piuttosto ristretto. Più comunemente, le relazioni di maggior interesse agrario e biologico in genere (per esempio la crescita di una coltura, la cinetica degradativa degli erbicidi nel terreno, la risposta produttiva delle colture a densità crescenti di malerbe o a dosi crescenti di concime, la risposta fitotossica di una specie infestante alla dose di un erbicida) sono curvilinee, posseggono punti di massimo o minimo, flessi e, soprattutto, asintoti.\n\n# Forme funzionali\n\nUno dei criteri fondamentali, ancorché empirico, per la selezione di una\ncurva è quello di considerarne la forma, in relazione al fenomeno\nbiologico in studio. Possiamo classificare le curve in base alla loro\nforma:\n\n-   Polinomiali\n    1.  Retta\n    2.  Parabola\n-   Curve convesse\n    1.  Funzione esponenziale\n    2.  Funzione di potenza\n    3.  Equazione logaritmica\n    4.  Iperbole rettangolare\n    5.  Modello asintotico\n-   Curve sigmoidali\n    1.  Funzione logistica\n    2.  Funzione di Gompertz\n    3.  Funzione ’valori estremi’\n    4.  Funzione Log-logistica (Equazione di Hill)\n    5.  Weibull-1 (log-Gompertz)\n    6.  Weibull-2 (log-Extreme)\n-   Curve con massimi/minimi\n    1.  Equazione di Brain-Cousens\n    2.  Equazione di Braggs\n\n# Conoscere le funzioni\n\nPer ogni funzione è importante conoscere il significato biologico dei\nparametri, in quanto spesso l’informazione scientifica viene riassunta\nproprio in queste quantità stimate. Per questo motivo è spesso\nnecessario calcolare limiti, derivate ed integrali, almeno con l’aiuto\ndi un PC. Ovviamente, il semplice grafico può spesso aiutare a\ncomprendere la forma delle funzioni, per vedere se corrisponde\nall’andamento del fenomeno in studio.\n\n# Modelli lineari: curve polinomiali\n\nIn generale, relazioni matematiche curvilinee possono essere\napprossimate tramite funzioni polinomiali di ordine n. Si tratta di una\nfamiglia di funzioni molto flessibile, che contiene la funzione lineare\ncome caso particolare (n=1) e che permette di descrivere curvature anche\nmolto complesse semplicemente aumentando l’ ordine della funzione. In\nquesto modo è possibile ottenere un adattamento ai dati sperimentali\nteoricamente anche perfetto.\n\nLe funzioni polinomiali sono un tipico esempio di funzioni non-lineari\nnelle variabili, ma lineari nei parametri; esse possono essere trattate\nricorrendo alle metodiche di calcolo normalmente utilizzate per la\nregressione lineare.\n\nGli svantaggi delle funzioni polinomiali sono legati al fatto che queste\npresentano raramente giustificazione biologica. Per esempio, con le\nfunzioni polinomiali non è possibile descrivere relazioni asintotiche,\nche sono invece molto comuni in biologia.\n\nInoltre, le polinomiali possono approssimare bene una funzione solo in\nun intervallo della X molto ristretto e non consentono nessuna\nestrapolazione al di fuori di questo, dato che possono portare a stime\ndella risposta completamente insensate biologicamente.\n\nPer questi motivi l’ uso delle funzioni polinomiali dovrebbe essere\nlimitato ai casi in cui non si abbia nessuna conoscenza a priori dell’\nandamento del fenomeno. Tra l’ altro i moderni supporti informatici\nconsentono di risolvere il problema dell’ adattamento diretto di\nfunzioni curvilinee qualunque senza i lunghi calcoli manuali che\nvenivano richiesti fino ad alcuni anni fa.\n\n## Retta\n\n-   EQUAZIONE\n\n    $$Y = a + b  X$$\n\n-   PARAMETRI: *a* è il valore di Y quando X è uguale a 0, mentre *b* è\n    il tasso di crescita assoluto nell’unità di tempo (costante)\n\n-   FORMA: lineare crescente (b &gt; 0) o decrescente (b &lt;0)\n\n-   USO: approssimazione locale di fenomeni biologici\n\n-   VANTAGGI: semplicità di fitting\n\n## Parabola\n\n-   EQUAZIONE\n\n    $$Y = a + b  X + c  X^2$$\n\n-   DERIVATA PRIMA: $b + 2cX$\n\n-   DERIVATA SECONDA: $2c$\n\n-   PARAMETRI: *a* è il valore di Y quando X=0, *b* è la derivata prima\n    (tasso di crescita assoluto) quando X=0 e *c* è collegato alla\n    posizione del massimo/minimo assoluto, che si ottiene quando\n    $b + 2cX = 0$, cioè per $X = -b/(2c)$. Si tratta di un\n    massimo quando *c* &lt; 0, altrimenti è un minimo.\n\n-   FORMA: parabola\n\n-   USO: approssimazione locale di fenomeni biologici\n\n-   VANTAGGI: semplicità\n\n-   ALTRE INFORMAZIONI: E’ possibile calcolare l’ordinata del punto di\n    massimo/minimo, pari a:\n\n    $${Y_m} = \\frac{4ac - {b^2}}{4c}$$\n\n    che viene raggiunto quando:\n\n    $$x_m = \\frac{ - b}{2c}$$\n\n# Curve esponenziali\n\nLa funzione esponenziale descrive un *trend* di crescita/decrescita che\navviene con un tasso costante nel tempo. L’equazione generale è:\n\n$$Y = a  b^X  = a  e^{cX} =  e^{d + c X}$$\n\nI passaggi sono facili, ponendo $b = e^c$ e $a = e^d$:\n\n$$a  b^X  = a  (e^c)^{X} =  a  e^{cX}$$\n\nquindi:\n\n$$a  e^{cX} = e^d \\cdot e^{cX} =  e^{d + cX}$$\n\n## Caratteristiche\n\n-   PARAMETERS: A is the value of Y when X=0; b is the relative growth\n    rate (constant)\n\n-   SHAPE: Exponential growth (concave increasing; $c > 0$) and\n    exponential decay (concave decreasing $c < 0$)\n\n-   USAGE: degradation kinetics, exponential growth\n\n-   SELF STARTER FUNCTIONS: NLSexponential.1(), NLSexponential.2(),\n    DRCexponential.1(), DRCexponential.2()\n\n## First derivative\n\nPer la definizione della derivata prima poniamo:\n\n$$\\begin{array}{l}\n f(x) = a \\\\ \n g(x) = e^{h(x)} \\\\ \n h(x) = bX\n \\end{array}$$\n\nRicordiamo quindi la regola del prodotto:\n\n$$(f(x) \\cdot g(x))' = f'(x)g(x) + f(x)g'(x)$$\n\ne la regola di derivazione delle funzioni esponenziali:\n\n$$\\frac{d}{{dx}}e^{h(x)}  = e^{h(x)} h'(x)$$\n\ndove:\n\n$$\\begin{array}{l}\n f'(x) = 0 \\\\ \n h'(x) = b \\\\ \n g'(x) = e^{bX} b \\\\ \n \\end{array}$$\n\nda cui:\n\n$$\\frac{d}{{dx}}ae^{bX}  = bae^{bX}$$\n\ncioè\n\n$$\\frac{d}{{dx}}ae^{bX}  = bY$$\n\nPossiamo quindi definire il tasso di crescita relativo (RGR) come\nl’incremento di Y nell’unità di X, relativo al livello di Y in quel\nmomento:\n\n$$RGR = \\frac{d}{{dx}}ae^{bX} \\frac{1}{Y} = b$$\n\nLa funzione esponenziale descrive quindi una crescita/decrescita che\navviene con un tasso costante nel tempo.\n\ncurve(1\\*exp(x), from=0, to=5, ylab=“Y”, xlab=“X”) curve(150\\*exp(-x),\nadd=T, col=“red”)\n\n# Asymptotic regression\n\nTre fondamentali parametrizzazioni:\n\n$$a - (a - b) exp{- m  x}$$\n\n$$a - c  exp{- m  x}$$\n\n$$a (1 - b exp {- m x}$$\n\n-   ALSO KNOWN AS: monomolecular growth, Mitscherlich law, negative\n    exponential\n\n-   PARAMETERS: $a$: maximum attainable y; $b$ y at x=0; $c$\n    equals to $a - b$; $b$ is the ratio $c/a$, $m$\n    relates to the RGR\n\n-   SHAPE: convex increasing\n\n-   USAGE: growth studies\n\n-   SELF STARTER FUNCTIONS: DRCmonoGrowth.1, DRCmonoGrowth.2,\n    DRCmonoGrowth.3, NLSmonoGrowth.1, NLSmonoGrowth.2, NLSmonoGrowth.3\n\n## Curve PAR assorbito vs LAI\n\nSe io misuro la radiazione PAR trasmessa al suolo (es. con sensori\nlineari) e quella incidente sulla coltura, il rapporto\n$y = PAR_a / PAR_i$ può essere modellizzato come:\n\n$$y = 1 - exp( -k LAI)$$\n\nQuesta curva rappresenta un fenomeno asintotico (Amax = 1), con k che è\nil coefficiente di estinzione e rappresenta la capacità della coltura di\nintercettare la radiazione luminosa. L’ incremento di y per ogni unità\ndi LAI tende a essere sempre più piccolo. Il decremento è proporzionale\nal LAI già acquisito\n\n# Curve iperboliche (Iperbole rettangolare)\n\nThe general equation is:\n\n$$y = \\frac{a x} {b + x}$$\n\nCharacteristics:\n\n-   ALSO KNOWN AS: Michaelis-Menten model\n\n-   PARAMETERS: $a$: maximum value of the response; $b$ x value\n    at which half the maximum response is attained\n\n-   SHAPE: convex increasing\n\n-   USAGE: species-area curves, enzyme kinetics\n\n-   SELF STARTER FUNCTIONS: SSmicmen(); MM.2()\n\nThis is generally known as Michaelis-Menten equation, where $a$ is\nthe higher asymptote and $b$ is the $x$ that gives a response\nequal to $a/2$. Indeed:\n\n$$\\frac{a}{2} = \\frac{ax_{50} } {b + x_{50} }$$\n\nDa cui semplicemente otteniamo che $b = x_{50}$\n\nThe slope is:\n\n$$\\begin{array}{*{20}c}\n     {D\\left[ {ax\\cdot(b + x)^{ - 1} } \\right] = D(ax)\\cdot(b + x)^{ - 1}  + axD\\left[ {(b + x)^{ - 1} } \\right]}  \\\\\n     { = \\frac{a}{{b + x}} - \\frac{{ax}}{{\\left( {b + x} \\right)^2 }} = \\frac{{a(b + x) - ax}}{{\\left( {b + x} \\right)^2 }} = \\frac{{ab}}{{\\left( {b + x} \\right)^2 }}}  \\\\\n  \\end{array}$$\n\nWe can see that the initial slope is $i = a/b $.\n\nA self starting function may be built considering that:\n\n$$\\frac{1}{y} = \\frac{1}{a} + \\frac{b}{a} \\cdot \\frac{1}{x}$$\n\n## Competizione coltura-malerbe: curve densita’ produzione\n\nPer gli studi di competizione, dove la pendenza iniziale è importante\ncome indicatore di competitività di una specie infestante, la funzione è\nstata riparametrizzata includendo *i* come parametro esplicito (Cousens,\n1985). Sostituendo e semplificando otteniamo:\n\n$$y = \\frac{{ax}}{{\\frac{a}{i} + x}} = \\frac{{ax}}{{\\frac{{a + ix}}{i}}} = \\frac{{ix}}{{\\frac{{a + ix}}{a}}} = \\frac{{ix}}{{1 + \\frac{{ix}}{a}}}$$\n\nCioè:\n\n$$y = \\frac{i \\cdot x}{1 + \\frac{i \\cdot x}{A}}$$\n\nQuesta funzione è crescente ed è quindi utilizzata per modellizzare le\nperdite produttive ($Y_L$). Se volessimo modellizzare la produzione\ndella coltura in funzione della fittezza delle piante infestanti,\npotremmo considerare che:\n\n$$Y_L  = \\frac{{Y_{WF}  - Y_w }}{{Y_{WF} }}100$$\n\ndove $Y_W$ è la produzione nell’infestato e $Y_{WF}$ è la\nproduzione del testimone. Da cui deriviamo:\n\n$$Y_W  = Y_{WF}  - \\frac{{Y_L }}{{100}}Y_{WF}  = Y_{WF} \\left( {1 - \\frac{{Y_L }}{{100}}} \\right)$$\n\nquindi:\n\n$$Y_W  = Y_{WF} \\left( {1 - \\frac{{ix}}{{100\\left( {1 + \\frac{{ix}}{a}} \\right)}}} \\right)$$\n\n## Crescita delle colture: relazioni LAI vs biomassa\n\nSecondo Stockle and Nelson (2003), la relazione tra peso e LAI in una\nspecie vegetale segue la realazione:\n\n$$LAI = \\frac{{W \\cdot LAR}}{{1 + SLP{\\mkern 1mu}  \\cdot W}}$$\n\nquindi è tipicamente iperbolica. La derivata prima è:\n\n$$f'(LAI) = \\frac{{LAR}}{{{{\\left( {1 + SLP{\\mkern 1mu}  \\cdot W} \\right)}^2}}}$$\n\nda cui vediamo che nel punto W = 1 essa assume un valore pari a LAR.\nQuindi il LAR rappresenta l’incremento di LAI per i primissimi\nincrementi di peso (gli incrementi successivi saranno tutti minori di\nquesto). SLP invece definisce quanto veloce è il decremento della\npendenza all’aumentare del peso e quindi constribuisce a definire\nl’asinto superiore, che è pari a LAR/SLP\n\n# Power curve\n\nFREUNDLICH - ALLOMETRIC\n\n$$y = a \\cdot X ^ b = a \\cdot exp [(b \\cdot log(X)]$$\n\nThe power curve is as follows:\n\n$$a \\cdot x^b$$\n\nThis curve is perfectly equivalent to an exponential curve on the\nlogarithm of x:\n\n$$a \\cdot e^{b \\cdot log(x)}$$\n\n$$ax^b  = ae^{log(x^b )}  = a\\cdot\\exp ^{blog(x)}$$\n\nThe equation is:\n\n$$y = a x ^ {b}$$\n\nwhich assumes several shapes, according to $b$. If $b$ is\nnegative, the curve is decreasing. The slope is:\n\n$$y = a b x ^ {b - 1}$$\n\nIf $b$ is positive, the curve is increasing.\n\n### Self starting\n\nWe consider that:\n\n$$log(y) = log(a x ^ {b}) = log(a) + log(x ^ {b}) = log(a) + b log(x)$$\n\nwe can thus establish a linear regression on the natural logarithms of\n$x$ and $y$.\n\n-   ALSO KNOWN AS: Allometric function, Freundlich equation\n\n-   PARAMETERS: X must be $> 0$, b dictates the shape\n\n-   SHAPE: concave increasing ($b > 1$), concave decreasing\n    ($b < 0$) or convex increasing ($0 < b < 1$).\n\n-   USAGE: sorption of pesticides, species-area curves\n\n-   SELF STARTER FUNCTIONS: NLSpowerCurve(); DRCpowerCurve()\n\nNel caso delle curve area specie l’individuazione dell’area minima di\ncampionamento viene in genere effettuata con il metodo di\nMuller-Dumbois.\n\nSi individa graficamente la retta che unisce l’origine degli assi\ncartesiani, con il punto massimo osservato. Questa retta ha una pendenza\npari a max(y)/max(x). Questa retta unisce i punti con pari incremento\npercentuale delle due variabili (’100% delle specie-100%dell’area’ o\n’50% delle specie-50% dell’area’ e così via).\n\nSi calcola la derivata prima della curva di potenza, pari a\n$a b x ^{b-1}$ e la si eguaglia alla pendenza della retta sopra\nindicata, ottenendo così l’area alla quale corrisponde un incremento\nparitetico dello sforzo di campionamento con il guadagno informativo.\nPiù in particolare l’area minima individua quell’area alla quale ad un\nincremento del 10% della superficie corrisponde un incremento pari al\n10% delle specie (quindi un incremento informativo abbastanza\nirrilevante, rispetto allo sforzo di campionamento che questo\nrichiederebbe).\n\n# Logarithmic equation\n\nIT IS A LINEAR MODEL (on log-transformed x)!\n\n$$y = a + b \\cdot log(x)$$\n\n-   PARAMETERS: X must be $> 0$, b dictates the shape\n\n-   SHAPE: concave increasing ($b > 0$), concave decreasing\n    ($b < 0$)\n\n-   USAGE: species-area curves and many others\n\n-   SELF STARTER FUNCTIONS: NLSlogCurve(); DRClogCurve()\n\n# Logistic Curve\n\nLa curva logistica deriva dalla distribuzione logistica cumulativa:\n\n$$P(x) = \\frac{1} {[(1 + exp(-(x - a)/\\sigma)]}$$\n\ndove $a$ è la media/mediana (la distribuzione è simmetrica) e\n$\\sigma$ è la deviazione standard. La mediana è rilevante, perché\nrappresenta il valore di x quando Y è uguale a 0.5, cioè quando il\nfenomeno è nel suo punto ’intermedio’. Ad esempio, nel dosaggio\nbiologico (dove x è la dose ed y, ad esempio, la mortalità), $a$\nrappresenta la DL50, cioè la dose che comporta la morte del 50% degli\norganismi trattati.\n\nLa deviazione standard è poco interessante, se non per descrivere\ndistribuzioni di frequenza, ed è in genere sostituita con il suo\nreciproco b, cioè la pendenza nel punto di flesso. Questo parametro può\nessere sia negativo che positivo, potendo così ottenere curve sigmoidali\ncrescenti (se b è positivo) o decrescenti (se b è negativo):\n\n$$y = \\frac{1} {[(1 + exp(- b (x - a))]}$$\n\nLa curva soprastante varia tra 0 ed 1, ma è possibile includere un\nulteriore parametro (d) che rappresenta l’asintoto superiore:\n\n$$y = \\frac{d} {1 + exp(- b (x - a))}$$\n\ned un parametro per l’asintoto inferiore (c):\n\n$$y = c + \\frac{d - c}{1 + exp(- b (x - a))}$$\n\nCon questi asintoti il T50 non è più assoluto, ma relativo (half-way).\n\nCaratteristiche\n\n-   PARAMETERS: $d$: maximum attainable y, $c$: minimum\n    attainable y $a$ X50, $b$ slope at x50;\n\n-   SHAPE: symmetric sigmoid increasing ($b > 0$) or decreasing\n    ($b < 0$)\n\n-   SELF STARTER FUNCTIONS SSfpl(), SSlogis ($d$ = 0) (they give\n    $1/b$, instead of $b$)\n\n# Log-logistic curve\n\nIn many applications, the sigmoidal response curve is symmetric on the\nlogarithm of x, which requires a log-logistic curve (a log-normal curve\nwould be practically equivalent, but it is used far less often). For\nexample, in biologic assays (but also in germination assays), the\nlog-logistic curve is defined as follows:\n\n$$c + \\frac{d - c}{1 + exp(b ( log (x) - log (ED50)))}$$\n\nQuesta espressione è equivalente a\n\n$$c + \\frac{d - c}{1 + (x/ED50)^b}$$\n\nInfatti:\n\n$$c + \\frac{d - c}{1 + (x/ED50)^b}  = c + \\frac{d - c}{1 + exp (log (x/ED50)^b)} = $$\n\n$$= c + \\frac{d - c}{1 + exp (b \\, log (x/ED50))} = c + \\frac{d - c}{1 + exp (b ( log(x) - log(ED50)))}$$\n\nCaratteristiche\n\n-   PARAMETERS: $d$: maximum attainable y, $c$: minimum\n    attainable y $ED50$ X50, $b$ slope at x50;\n\n-   SHAPE: symmetric sigmoid increasing ($b > 0$) or decreasing\n    ($b < 0$)\n\n-   USAGE: growth studies and bioassay work (log-logistic or\n    Hill’s function)\n\n-   SELF STARTER FUNCTIONS SSfpl(), SSlogis ($d$ = 0) (they give\n    $1/b$, instead of $b$)\n\nConsidering a log-logistic model, the $a$ parameter coincides with\nthe ED50, while other ED levels may be estimated as follows:\n\n$$ED_l  = a \\times exp[ - \\frac{{\\log \\frac{{100 - l}}{l}}}{b}]$$\n\nwhere l is the desired effect level (10 for ED10, 90 for ED90 an so on).\nA standard error for these quantities may be estimated via the so-called\ndelta method (HuetBouvierEtAl2004a).\n\nIt should be emphasised that these ED levels are relative to upper and\nlower asymptotes and do not necessarily refer to the attainable weed\ncontrol level. For example, if we have a dose-response curve with higher\nasymptote equal to 90 g plant$^{-1}$ and lower asymptote equal to 20\ng plant$^{-1}$, the ED50 produces a response reduction half-way\nbetween higher and lower asymptotes, which corresponds to a weight of 55\ng plant$^-1$ (i.e. (90-20)/2 + 20) and to an absolute weed control\nof 38.9% (i.e. (1 - 55/90) x 100). It is always necessary to keep in\nmind that the effect levels produced by EDs coincide with the absolute\nweed control levels only when the lower asymptote is equal to 0.\n\nTherefore, if one is interested in the dose producing a certain absolute\ncontrol level, he should seek for the corresponding relative effect\nlevel, by using the following equation:\n\n$$l = 100 - \\frac{Y_l  - C}{D - C} 100$$\n\nwhere $l$ is the relative effect level, while $Y_l$ is the\nexpected response. In the above example, if we are interested in the\ndose that would produce 50% weed control, we set $Y_l = 45$ and\nobtain $l = 64.3$. Indeed, we should estimate the ED64.3 level.\n\nAnother way is to use the values of estimated parameters to calculate\nthe absolute ED level at $Y_l$,($ED_{Y_{l}}$) by using the\nfollowing equation:\n\n$$ED_{Y_l} = exp \\left\\{ log \\left[ \\frac{\\frac{Y_l- C}{D - C}}{b} \\right] + log(ED50) \\right\\}$$\n\nDa cui ricaviamo che:\n\n$$ED_{50} = exp \\left\\{ log \\left[ \\frac{\\frac{Y_l- C}{D - C}}{b} \\right] + log(ED_{Y_l}) \\right\\}$$\n\nPertanto, se procediamo al fitting  \n\nEffective doses are calculated form a log-logistic equation as:\n\n$$ED_x = ED_{flesso} exp (-log((100-x)/x)/b) )$$\n\nConsideriamo ad esempio l’ED10:\n\n$$ED10 = EDflesso exp (-log((100-10)/10)/b)$$\n\nDerivate prima:\n\n$$f1 = f'(EDflesso) = exp (-log(9)/b)$$\n\n$$f2 = f'(b) = EDflesso * exp (-log(9)/b) * log(9)/(b^2)$$\n\nCon questo procedo con la formula usuale (vedi sopra). Se voglio un ED\ntype Absolute, posso ricalcolare l’ED relative necessario, con la\nseguente formula:\n\n$$10\\%_rel = (D*0.1 - C)/(D - C)$$\n\n## CALCOLO EFFICIENZA RELATIVA PER CURVE NON PARALLELE\n\nSe ho calcolato EDflesso, posso calcolare la R per questo livello di ED\ncome indicato sopra. Se voglio calcolare la R per altri livelli di ED,\nposso operare così (esempio per ED10):\n\n$$Rx = EDflesso_a exp (-log(9)/b_a) / EDflesso_b exp (-log(9)/b_b)$$\n\nSe b è uguale per le due curve, si ritorna alla formula più sopra (R\ncostante).\n\nIn questo caso ho quattro parametri, con le relative varianze e\ncovarianze. Le derivate prime sono:\n\n    > D(expression((a * exp (-log(9)/b)) / (c * exp (-log(9)/d))), \"a\")\n    exp(-log(9)/b)/(c * exp(-log(9)/d))\n     \n    > D(expression((a * exp (-log(9)/b)) / (c * exp (-log(9)/d))), \"b\")\n    a * (exp(-log(9)/b) * (log(9)/b^2))/(c * exp(-log(9)/d))\n     \n    > D(expression((a * exp (-log(9)/b)) / (c * exp (-log(9)/d))), \"c\")\n    -((a * exp(-log(9)/b)) * exp(-log(9)/d)/(c * exp(-log(9)/d))^2)\n     \n    > D(expression((a * exp (-log(9)/b)) / (c * exp (-log(9)/d))), \"d\")\n    -((a * exp(-log(9)/b)) * (c * (exp(-log(9)/d) * (log(9)/d^2)))/(c *\n        exp(-log(9)/d))^2)\n    > \n\nCon queste posso procedere come usuale.\n\n# Gompertz Curve\n\nGompertz equation is:\n\na exp(-b exp(-c x)) b&gt; 0 and c&gt;0\n\na is the upper asymptote. Making a=1 we get the Gumbell distribution,\nthat is reparameterised as:\n\nexp(- exp \\[-(x - mu)/beta\\])\n\nThis CDF depicts a function that is sharp at the beginning and slow at\nthe end (left skewed) and it is uncorrectly labelled as Gompertz\ndistribution\n\nThis is also Type I Extreme value distribution\n\nThe Gompertz equation is derived from the following differential\nequation, that is used in plant growth studies:\n\n$$W' = \\frac{{dW}}{{dt}} = mWe^{ - ct}$$\n\nwhere W is the weight at time t. If we consider the Relative Growth Rate\n(RGR), the expression is:\n\n$$RGR = \\frac{{dW}}{{dt}} \\cdot \\frac{1}{W} = m e^{ - ct}$$\n\nand we see that when $t = 0$ RGR = m. Likewise, if we consider the\nsecond derivative:\n\n$$W'' = W' \\cdot c \\left( \\frac{m}{c} e^{-2ct} - e^{-ct} \\right)$$\n\nwe notice that this expression equal to 0 when:\n\n$$\\frac{m}{c} e^{-2ct} - e^{-ct}  = 0$$\n\nif we set:\n\n$$e^k = \\frac{m}{c}$$\n\nthen:\n\n$$e^{k - 2ct} - e^{-ct}  = 0$$\n\nwhich equals to:\n\n$$k - 2ct + ct  = 0$$\n\nSo the second derivative is 0 at $t = k/c$, which represent the\ninflection point. At this point, the RGR equals to c, that indeed\nrepresents the RGR at inflection point.\n\nIntegrating equation \\[FirstDer\\] we obtain the following\nparameterisation:\n\n$$\\label{GompOne}\nW = W_0 \\exp \\left[ {\\frac{{m\\left( {1 - e^{ - ct} } \\right)}}{c}} \\right]$$\n\nThis equation may be also reparameterised to include an explicit upper\nasymptote, which is often of biological interest. We can observe from\n(\\[GompOne\\]) that the upper asymptote $W_f$ equals to:\n\n$$W_f  = W_0 \\cdot \\exp \\left( {\\frac{m}{c}} \\right)$$\n\nindeed:\n\n$$\\begin{array}{l}\n \\log \\left( {\\frac{{W_f }}{{W_0 }}} \\right) = \\frac{m}{c} \\\\ \n \\\\\n c = \\frac{m}{{\\log \\left( {\\frac{{W_f }}{{W_0 }}} \\right)}} \\\\ \n \\end{array}$$\n\nIncluding the above quantity on equation \\[GompOne\\], we obtain:\n\n$$label{GompTwo}\nW = W_0 \\exp \\left\\{ { \\log \\left( \\frac{W_f}{W_0} \\right) - \\log \\left( {\\frac{{W_f }}{{W_0 }}} \\right)\\exp \\left( {\\frac{{ - mt}}{{\\log \\left( {\\frac{{W_f }}{{W_0 }}} \\right)}}} \\right)} \\right\\}$$\n\nwhich is sometimes used for fitting purposes.\n\nConsidering that growth curves are usually determined on the logarithm\nof weight, we can define the following parameterisation:\n\n$$\\begin{array}{l}\n \\log \\left( W \\right) = \\log \\left\\{ {W_0  \\cdot \\exp \\left\\{ {\\frac{m}{D}\\left( {1 - e^{ - Dt} } \\right)} \\right\\}} \\right\\} =  \\\\ \n  = \\log \\left( {W_0 } \\right) + \\frac{m}{D}\\left( {1 - e^{ - Dt} } \\right) \\\\ \n \\end{array}$$\n\nAll the above parameterisations are specifically used for growth curves,\neven though their estimation properties are not always good, due to the\npresence of $W_0$. Thus more general parameterisation can be\ndefined.\n\n### Other parameterisations\n\nEquation \\[GompOne\\] may be reduced as follows:\n\n$$\\begin{array}{l}\n W_0  = a \\cdot e^{ - b}  \\\\ \n m = b \\cdot c \\\\  \n W = a \\cdot {\\mathop{\\rm e}\\nolimits} ^{ - b}  \\cdot \\exp \\left[ {\\frac{{bc\\left( {1 - e^{ - ct} } \\right)}}{c}} \\right] = a \\cdot {\\mathop{\\rm e}\\nolimits} ^{ - b}  \\cdot e^{\\left( {b\\left( {1 - e^{ - ct} } \\right)} \\right)}  =  \\\\\n \\\\ \n  = a \\cdot e^{ - b}  \\cdot e^{b - be^{ - ct} }  = a \\cdot e^{ - b + b - be^{ - ct} }  = a \\cdot e^{ - b \\cdot e^{ - ct} }  \\\\ \n\\end{array}$$\n\nWe obtain the general Gompertz form:\n\n$$y = a e^{-b e^{- c x}}\n\\label{GompTrad}$$\n\nThis form has excellent estimation properties; $a$ is upper\nasymptote, $c$ is RGR at inflection point, $b$ does not have a\nclear biological meaning (see above).\n\nIf we set:\n\n$$b = e^k$$ da cui:\n\nthan we obtain another good parameterisation:\n\n$$W = a \\cdot e^{-e^{k} \\cdot e ^ {-cx}} = a \\cdot e^{-e^{k - cx}}$$\n\nthat is frequently used. It is also possible to consider that the\ninflection point is at $d = k/c$ and incorporate it on the following\nparameterisation:\n\n$$W = a \\cdot e^{-e^{\\delta c - cx}} = a \\cdot e^{-e^{c (\\delta  - x)}}$$\n\nHere we can also incorporate the initial RGR:\n\n$$W = a \\cdot e^{-e^{\\frac{m}{b} (\\delta  - x}}$$\n\n### Self starting\n\nWe can build a self starter function for equation \\[GompTrad\\] by\nconsidering that:\n\n$$- \\log \\left( {\\frac{W}{a}} \\right) = be^{ - cx}$$\n\nif we pose:\n\n$$b = e^k$$\n\nthen we can define :\n\n$$pseudoY = \\log \\left( { - \\log \\left( {\\frac{W}{a}} \\right)} \\right) = k - cx$$\n\nWe can thus an initial value for $a$ by taking respectively the\nmaximum observed value for y and we can later set the linear regression\nof $pseudoY$ against $x$.\n\n$$c + (d - c) \\times exp(-exp(b (x - e))$$\n\n-   PARAMETERS: $d$: maximum attainable y, $c$: minimum\n    attainable y $a$ X50, $b$ slope around inflection;\n\n-   SHAPE: asymmetric sigmoid increasing ($b > 0$) or decreasing\n    ($b < 0$)\n\n-   USAGE: growth studies and bioassay work (log-Gompertz or\n    Weibull-1 function)\n\n-   SELF STARTER FUNCTION: SSGompertz ($d$ = 0)\n",
    "created" : 1519290468736.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "745402790",
    "id" : "BE886EC0",
    "lastKnownWriteTime" : 1519290451,
    "last_content_update" : 1519290451,
    "path" : "~/Documents/_DBXAndrea/Dropbox/_Lavoro/__Notes/__Stats/90 - NonLinearRegression/_Letio_UsefulEquations (Lezione)/usefulEquations.md",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "markdown"
}